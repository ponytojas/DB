select * from grupo where genero_grupo = 'Jazz';
select musico.nombre_musico, musico.apellidos_musico from musico inner join instrumento_musico on instrumento_musico.dni_musico = musico.dni_musico inner join instrumento on instrumento.nombre_instrumento = instrumento_musico.nombre_instrumento where tipo_instrumento = 'Bateria';
select musico.nombre_musico, musico.apellidos_musico from musico inner join instrumento_musico on instrumento_musico.dni_musico = musico.dni_musico inner join instrumento on instrumento.nombre_instrumento = instrumento_musico.nombre_instrumento inner join musico_grupo on musico_grupo.dni_musico = musico.dni_musico inner join grupo on grupo.id_grupo = musico_grupo.id_grupo where tipo_instrumento = 'Saxofon' and grupo.genero_grupo = 'Jazz';
select grupo.nombre_grupo from grupo inner join concierto on concierto.id_grupo = grupo.id_grupo inner join pais_concierto on concierto.ciudad_concierto = pais_concierto.ciudad_concierto where pais_concierto = 'ESPAÑA';
select disco.titulo_disco from disco inner join cancion_disco on disco.id_disco = cancion_disco.id_disco group by disco.titulo_disco having count(cancion_disco.id_disco) >= 10;
select grupo.nombre_grupo from grupo inner join musico_grupo on grupo.id_grupo = musico_grupo.id_grupo group by grupo.nombre_grupo having count (musico_grupo.dni_musico) > 3;
SELECT OPINION_DISCO.PUNTUACION, DISCO.TITULO_DISCO FROM OPINION_DISCO INNER JOIN COMPRA_DISCO ON OPINION_DISCO.ID_DISCO = COMPRA_DISCO.ID_DISCO INNER JOIN USUARIO_COMPRA ON USUARIO_COMPRA.ID_COMPRA = COMPRA_DISCO.ID_COMPRA INNER JOIN DISCO ON OPINION_DISCO.ID_DISCO = DISCO.ID_DISCO GROUP BY OPINION_DISCO.PUNTUACION, DISCO.TITULO_DISCO HAVING COUNT(USUARIO_COMPRA.DNI_USUARIO) >= 3;
select disco.titulo_disco from disco inner join cancion_disco on cancion_disco.id_disco = disco.id_disco inner join cancion on cancion.id_cancion = cancion_disco.id_disco inner join disco_grupo on disco_grupo.id_disco = disco.id_disco inner join grupo on grupo.id_grupo = disco_grupo.id_grupo where grupo.genero_grupo = 'Rock' group by disco.titulo_disco  having count(cancion.duracion > 5) >= 1;
select musico.* from musico inner join musico_grupo on musico.dni_musico = musico_grupo.dni_musico inner join grupo on grupo.id_grupo = musico_grupo.id_grupo inner join concierto on concierto.id_grupo = grupo.id_grupo inner join entrada on entrada.id_concierto = concierto.id_concierto where entrada.id_entrada in (select precio_entrada.id_entrada from precio_entrada where precio_entrada.precio_entrada > cast(100 as money)) and concierto.ciudad_concierto = 'MADRID';
select opinion_concierto.puntuacion from opinion_concierto inner join concierto on concierto.id_concierto = opinion_concierto.id_concierto inner join entrada on entrada.id_concierto = concierto.id_concierto inner join precio_entrada on precio_entrada.id_entrada = entrada.id_entrada inner join compra_entrada on compra_entrada.id_entrada = precio_entrada.id_entrada where precio_entrada.precio_entrada > cast(100 as money) and concierto.ciudad_concierto = 'MADRID';
select cancion.*, musico.nombre_musico, musico.apellidos_musico from cancion inner join compositor_cancion on compositor_cancion.id_cancion = cancion.id_cancion inner join musico on musico.dni_musico = compositor_cancion.dni_musico inner join cancion_disco on cancion_disco.id_disco = cancion.id_cancion inner join disco on cancion_disco.id_disco = disco.id_disco where disco.genero_disco = 'Heavy Metal' and disco.fecha_edicion >= '2018-01-01' and disco.fecha_edicion <= '2018-12-31';
select musico.nombre_musico, musico.apellidos_musico, disco.titulo_disco, disco_digital.tamaÑo_disco from musico inner join musico_grupo on musico_grupo.dni_musico = musico.dni_musico inner join grupo on grupo.id_grupo = musico_grupo.id_grupo inner join disco_grupo on disco_grupo.id_grupo = grupo.id_grupo inner join disco_digital on disco_digital.id_disco = disco_grupo.id_disco inner join disco on disco_grupo.id_disco = disco.id_disco where grupo.genero_grupo = 'Jazz';
select usuario.nombre_usuario, usuario.apellidos_usuario from usuario inner join usuario_compra on usuario.dni_usuario = usuario_compra.dni_usuario inner join compra_entrada on usuario_compra.id_compra = compra_entrada.id_compra inner join entrada on entrada.id_entrada = entrada.id_entrada inner join concierto on entrada.id_concierto = entrada.id_concierto inner join grupo on grupo.id_grupo = concierto.id_grupo where grupo.genero_grupo = 'Rock' and concierto.fecha_concierto >= '2018-01-01' and concierto.fecha_concierto >= '2018-12-31' group by usuario.nombre_usuario, usuario.apellidos_usuario;
select disco.titulo_disco, cancion.nombre_cancion from cancion inner join cancion_disco on cancion.id_cancion = cancion_disco.id_cancion inner join disco on disco.id_disco = cancion_disco.id_disco inner join compra_disco on compra_disco.id_disco = disco.id_disco inner join usuario_compra on usuario_compra.id_compra = compra_disco.id_compra inner join opinion_disco on opinion_disco.id_disco = disco.id_disco group by disco.titulo_disco, cancion.nombre_cancion having avg(opinion_disco.puntuacion) >= 7;
select grupo.nombre_grupo, musico.nombre_musico, musico.apellidos_musico from grupo inner join musico_grupo on musico_grupo.id_grupo = grupo.id_grupo inner join musico on musico.dni_musico = musico_grupo.dni_musico inner join concierto on concierto.id_grupo = grupo.id_grupo inner join disco_grupo on disco_grupo.id_grupo = grupo.id_grupo inner join disco on disco.id_disco = disco_grupo.id_disco inner join cancion_disco on cancion_disco.id_disco = disco.id_disco inner join pais_concierto on concierto.ciudad_concierto = pais_concierto.ciudad_concierto where not pais_concierto.pais_concierto = 'ESPAÑA' group by grupo.nombre_grupo, musico.nombre_musico, musico.apellidos_musico having count(cancion_disco.id_cancion) >= 10;
select cancion.nombre_cancion, musico.nombre_musico, musico.apellidos_musico from cancion inner join compositor_cancion on compositor_cancion.id_cancion = cancion.id_cancion inner join musico on musico.dni_musico = compositor_cancion.dni_musico inner join cancion_disco on cancion_disco.id_cancion = cancion.id_cancion inner join disco on disco.id_disco = cancion_disco.id_disco inner join disco_grupo on disco_grupo.id_disco = disco.id_disco inner join grupo on grupo.id_grupo = disco_grupo.id_grupo inner join concierto on concierto.id_grupo = grupo.id_grupo where not fecha_concierto < '2017-01-01' and fecha_concierto > '2017-12-31' group by cancion.nombre_cancion, musico.nombre_musico, musico.apellidos_musico;