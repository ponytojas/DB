
/* TRIGGER PARA CALCULO DE PUNTOS */

CREATE TRIGGER CUENTAPUNTOS BEFORE UPDATE ON COMPRA
REFERENCING NEW ROW AS PUNTOS_GANADOS
FOR EACH ROW
BEGIN  
    UPDATE COMPRA SET PUNTOS_GANADOS = 0,1 * PRECIO_ENTRADA.PRECIO_ENTRADA WHERE PRECIO_ENTRADA.ID_ENTRADA = COMPRA_ENTRADA.ID_ENTRADA 
    AND COMPRA_ENTRADA.ID_COMPRA = COMPRA.ID_COMPRA; 

    UPDATE COMPRA SET PUNTOS_GASTADOS = 0,05 * PRECIO_ENTRADA.PRECIO_ENTRADA WHERE PRECIO_ENTRADA.ID_ENTRADA = COMPRA_ENTRADA.ID_ENTRADA 
    AND COMPRA_ENTRADA.ID_COMPRA = COMPRA.ID_COMPRA; 
